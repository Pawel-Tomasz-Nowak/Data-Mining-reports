---
title: "Sprawozdanie z listy 2"
subtitle: "Eksploracja danych"
author: "Marta Stankiewicz (282244)  \n Paweł Nowak (282223)"
date: "`r Sys.Date()`"
header-includes:
   - \usepackage[OT4]{polski}
   - \usepackage[utf8]{inputenc}
   - \usepackage{graphicx}
   - \usepackage{float}
output: 
  pdf_document:
    toc: true
    fig_caption: true
    fig_width: 5 
    fig_height: 4 
    number_sections: true
fontsize: 12pt 
lof: true
lot: true
---


---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
knitr::opts_chunk$set(fig.pos = "H", out.extra ='', fig.align = "center")

```

```{r importing libraries, warning=FALSE, include=FALSE}
# Importing necessary libraries.
library(datasets)
library(dplyr)
library(ggplot2)
library(GGally)
library(gridExtra)
```



```{r data reading, include=FALSE}
# Reading the 'iris' data set.
data("iris") 
iris_df <- iris


num.cols <- colnames(iris_df %>% dplyr::select( where(is.numeric))) # Find the numerical variables.
print(num.cols)
```


# Zadanie 1.
## Wykresy skrzypcowe z wykresem pudełkowym dla zmiennych ciągłych

W celu zbadania zdolności dyskryminacyjnej cech, posłużymy się wykresem skrzypcowo-pudełkowym (tj. wykresem skrzypcowym wraz z wykresem pudełkowym). 

```{r violin boxplots, echo=FALSE, fig.width = 9, fig.height = 8, fig.cap = "Wykresy skrzypcowo-pudełkowe dla zmiennych ciągłych"}
  # Create a violin-with-box plot for each continous variable and arrange them in a figure.
    violin.plot.box_maker <- function(var){
    ggplot(data = iris_df, 
           aes(x = Species, y = iris_df[[var]], fill = Species)) +
      geom_violin(alpha = 0.2) +
      geom_boxplot(width = 0.15) +
        ylab(gsub("\\.", " ", var)) + 
        labs(title = paste("Wykres skrzypcowo-pudełkowy zmiennej\n",var))
    
    }
    
    grid.arrange(violin.plot.box_maker("Sepal.Length"), violin.plot.box_maker("Sepal.Width"),
               violin.plot.box_maker("Petal.Length"),
              violin.plot.box_maker("Petal.Width")
              )

```

Z wykresów \ref{fig:violin boxplots} wnioskujemy, że największe zdolności dyskryminacyjne wykazuje zmienna *Petal.Width*. Z kolei najmniejsze zdolności do separacji gatunków obserwujemy u zmiennej *Sepal.Width*.
